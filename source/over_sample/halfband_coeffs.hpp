// Copyright (C) 2025 - zsliu98
// This file is part of ZLEqualizer
//
// ZLEqualizer is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License Version 3 as published by the Free Software Foundation.
//
// ZLEqualizer is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more details.
//
// You should have received a copy of the GNU Affero General Public License along with ZLEqualizer. If not, see <https://www.gnu.org/licenses/>.

#pragma once

#include <array>

namespace zldsp::oversample::halfband_coeff {
    enum CoeffID {
        k128,
        k112,
        k96,
        k80,
        k64,
        k32,
    };

    template <typename FloatType, typename... Args>
    constexpr std::array<FloatType, sizeof...(Args)> make_typed_array(Args&&... args) {
        return { static_cast<FloatType>(std::forward<Args>(args))... };
    }

    template<typename FloatType>
    static constexpr auto kCoeff_128 = make_typed_array<FloatType>(
        0.0,-7.589279541189859e-06,0.0,1.4322198605841796e-05,0.0,-2.7380287261432315e-05,0.0,4.7790630588522576e-05,0.0,-7.826800528847528e-05,0.0,0.0001221591262825996,0.0,-0.00018350441382302164,0.0,0.0002671025687012894,0.0,-0.00037858077733224165,0.0,0.0005244558935677614,0.0,-0.000712188587719194,0.0,0.00095026346616979,0.0,-0.0012482872038164262,0.0,0.0016171012170058338,0.0,-0.002068984057576941,0.0,0.0026179440547305626,0.0,-0.0032801176352411994,0.0,0.004074486282614598,0.0,-0.005023854562262474,0.0,0.006156485416352043,0.0,-0.0075085926887796545,0.0,0.009128402951750795,0.0,-0.011082852111318906,0.0,0.013469121070997207,0.0,-0.01643548764996211,0.0,0.02022149050366075,0.0,-0.025241966062312767,0.0,0.032283134310455514,0.0,-0.04303475295762194,0.0,0.0618992696522245,0.0,-0.1050370809784316,0.0,0.31795303787353063,0.5000000005001011,0.31795303787353063,0.0,-0.1050370809784316,0.0,0.0618992696522245,0.0,-0.04303475295762194,0.0,0.032283134310455514,0.0,-0.025241966062312767,0.0,0.02022149050366075,0.0,-0.01643548764996211,0.0,0.013469121070997207,0.0,-0.011082852111318906,0.0,0.009128402951750795,0.0,-0.0075085926887796545,0.0,0.006156485416352043,0.0,-0.005023854562262474,0.0,0.004074486282614598,0.0,-0.0032801176352411994,0.0,0.0026179440547305626,0.0,-0.002068984057576941,0.0,0.0016171012170058338,0.0,-0.0012482872038164262,0.0,0.00095026346616979,0.0,-0.000712188587719194,0.0,0.0005244558935677614,0.0,-0.00037858077733224165,0.0,0.0002671025687012894,0.0,-0.00018350441382302164,0.0,0.0001221591262825996,0.0,-7.826800528847528e-05,0.0,4.7790630588522576e-05,0.0,-2.7380287261432315e-05,0.0,1.4322198605841796e-05,0.0,-7.589279541189859e-06,0.0
    );

    template<typename FloatType>
    static constexpr auto kCoeff_112 = make_typed_array<FloatType>(
        0.0,-5.718197058796207e-06,0.0,1.340878259788414e-05,0.0,-2.8501585896583806e-05,0.0,5.404839165492457e-05,0.0,-9.478231167202323e-05,0.0,0.00015678503611349666,0.0,-0.0002476653662071017,0.0,0.00037673635942687316,0.0,-0.0005551858114990934,0.0,0.0007962439740682993,0.0,-0.001115360632912561,0.0,0.001530454299296568,0.0,-0.0020622235753185807,0.0,0.0027346741586126745,0.0,-0.0035759384939894234,0.0,0.0046196434457468905,0.0,-0.005907164558085645,0.0,0.007491401738394888,0.0,-0.009443217396633237,0.0,0.011862722624606295,0.0,-0.014899919390348884,0.0,0.01879471192690399,0.0,-0.023960846461565693,0.0,0.031181974197221816,0.0,-0.04214386131951646,0.0,0.06124364711993803,0.0,-0.10463520525913403,0.0,0.317814598524989,0.499994370254192,0.317814598524989,0.0,-0.10463520525913403,0.0,0.06124364711993803,0.0,-0.04214386131951646,0.0,0.031181974197221816,0.0,-0.023960846461565693,0.0,0.01879471192690399,0.0,-0.014899919390348884,0.0,0.011862722624606295,0.0,-0.009443217396633237,0.0,0.007491401738394888,0.0,-0.005907164558085645,0.0,0.0046196434457468905,0.0,-0.0035759384939894234,0.0,0.0027346741586126745,0.0,-0.0020622235753185807,0.0,0.001530454299296568,0.0,-0.001115360632912561,0.0,0.0007962439740682993,0.0,-0.0005551858114990934,0.0,0.00037673635942687316,0.0,-0.0002476653662071017,0.0,0.00015678503611349666,0.0,-9.478231167202323e-05,0.0,5.404839165492457e-05,0.0,-2.8501585896583806e-05,0.0,1.340878259788414e-05,0.0,-5.718197058796207e-06,0.0
    );

    template<typename FloatType>
    static constexpr auto kCoeff_96 = make_typed_array<FloatType>(
        0.0,-7.011373421630453e-06,0.0,1.905616341246523e-05,0.0,-4.375177254202257e-05,0.0,8.797554608396915e-05,0.0,-0.00016171919204340811,0.0,0.0002781122084371609,0.0,-0.00045387202300395504,0.0,0.0007097453043541522,0.0,-0.0010709172767751922,0.0,0.0015675170409947391,0.0,-0.002235257551847662,0.0,0.0031165059378570063,0.0,-0.004262080984156821,0.0,0.005734476458198979,0.0,-0.00761366504283247,0.0,0.010007724802639303,0.0,-0.013072847031173226,0.0,0.017052782760371473,0.0,-0.02236236300247767,0.0,0.02978330653969121,0.0,-0.04099638990229898,0.0,0.06039088751088827,0.0,-0.10411039310157488,0.0,0.3176399320938326,0.49999890823462523,0.3176399320938326,0.0,-0.10411039310157488,0.0,0.06039088751088827,0.0,-0.04099638990229898,0.0,0.02978330653969121,0.0,-0.02236236300247767,0.0,0.017052782760371473,0.0,-0.013072847031173226,0.0,0.010007724802639303,0.0,-0.00761366504283247,0.0,0.005734476458198979,0.0,-0.004262080984156821,0.0,0.0031165059378570063,0.0,-0.002235257551847662,0.0,0.0015675170409947391,0.0,-0.0010709172767751922,0.0,0.0007097453043541522,0.0,-0.00045387202300395504,0.0,0.0002781122084371609,0.0,-0.00016171919204340811,0.0,8.797554608396915e-05,0.0,-4.375177254202257e-05,0.0,1.905616341246523e-05,0.0,-7.011373421630453e-06,0.0
    );

    template<typename FloatType>
    static constexpr auto kCoeff_80 = make_typed_array<FloatType>(
        0.0,-1.3752033593920446e-05,0.0,4.0714410587752406e-05,0.0,-9.769319710039177e-05,0.0,0.00020270565055552838,0.0,-0.0003813774114801438,0.0,0.0006673886231336097,0.0,-0.0011035245949348096,0.0,0.0017427933245029864,0.0,-0.0026498760801127526,0.0,0.0039036112675090258,0.0,-0.005601645902428843,0.0,0.007869626089199827,0.0,-0.010879574267931512,0.0,0.01488772258956315,0.0,-0.020316576249566853,0.0,0.027949620109682112,0.0,-0.03946287060326421,0.0,0.059234285314563935,0.0,-0.10339004702290314,0.0,0.31739102699618205,0.4999912491498217,0.31739102699618205,0.0,-0.10339004702290314,0.0,0.059234285314563935,0.0,-0.03946287060326421,0.0,0.027949620109682112,0.0,-0.020316576249566853,0.0,0.01488772258956315,0.0,-0.010879574267931512,0.0,0.007869626089199827,0.0,-0.005601645902428843,0.0,0.0039036112675090258,0.0,-0.0026498760801127526,0.0,0.0017427933245029864,0.0,-0.0011035245949348096,0.0,0.0006673886231336097,0.0,-0.0003813774114801438,0.0,0.00020270565055552838,0.0,-9.769319710039177e-05,0.0,4.0714410587752406e-05,0.0,-1.3752033593920446e-05,0.0
    );

    template<typename FloatType>
    static constexpr auto kCoeff_64 = make_typed_array<FloatType>(
        0.0,-2.0526342754056104e-05,0.0,7.432632011444925e-05,0.0,-0.0001997437506052046,0.0,0.0004504653414401026,0.0,-0.0009038274156349844,0.0,0.0016643590589274508,0.0,-0.002868078788245959,0.0,0.004689101518935132,0.0,-0.007353232120937136,0.0,0.011169303066099746,0.0,-0.016603870621667224,0.0,0.024468850242212535,0.0,-0.036447499001679394,0.0,0.05690086126457956,0.0,-0.10191444681809153,0.0,0.31689015874812304,0.4999987233308908,0.31689015874812304,0.0,-0.10191444681809153,0.0,0.05690086126457956,0.0,-0.036447499001679394,0.0,0.024468850242212535,0.0,-0.016603870621667224,0.0,0.011169303066099746,0.0,-0.007353232120937136,0.0,0.004689101518935132,0.0,-0.002868078788245959,0.0,0.0016643590589274508,0.0,-0.0009038274156349844,0.0,0.0004504653414401026,0.0,-0.0001997437506052046,0.0,7.432632011444925e-05,0.0,-2.0526342754056104e-05,0.0
    );

    template<typename FloatType>
    static constexpr auto kCoeff_32 = make_typed_array<FloatType>(
        0.0,-6.969295281075789e-05,0.0,0.000518800636706453,0.0,-0.00218652497381,0.0,0.006775880043233481,0.0,-0.017267186308453517,0.0,0.03926130564695248,0.0,-0.08937022623011512,0.0,0.3123369115134963,0.4999999133882062,0.3123369115134963,0.0,-0.08937022623011512,0.0,0.03926130564695248,0.0,-0.017267186308453517,0.0,0.006775880043233481,0.0,-0.00218652497381,0.0,0.000518800636706453,0.0,-6.969295281075789e-05,0.0
    );

    template<typename FloatType>
    static std::span<const FloatType> getCoeffByID(const CoeffID id) {
        switch (id) {
            case k128:
                return kCoeff_128<FloatType>;
            case k112:
                return kCoeff_112<FloatType>;
            case k96:
                return kCoeff_96<FloatType>;
            case k80:
                return kCoeff_80<FloatType>;
            case k64:
                return kCoeff_64<FloatType>;
            case k32:
            default:
                return kCoeff_32<FloatType>;
        }
    }
}
